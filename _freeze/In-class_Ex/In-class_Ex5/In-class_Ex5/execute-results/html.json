{
  "hash": "85573f16fe63b8b46ff43e21522e4e0a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"In Class Exercise 5\"\nauthor: \"Arjun Singh\"\ndate: 2024-09-23\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  freeze: true\n  warning: false\nformat:\n  html:\n    css: styles.css  \n---\n\n\n\n# 5 Introduction\n\nThis exercise will help reinforce our learning from Hands on exercise 5. Additionally, we explore the sfdep package and its uses.\n\n# 5.1 Objective\n\nIn spatial policy, a key objective for local governments and urban planners is to promote balanced development across the province. In this study, our goal is to apply appropriate spatial statistical methods to assess whether development is evenly distributed geographically in Hunan Province, People's Republic of China, using GDP per capita as a development indicator.\n\nIf we find that development is not evenly distributed, our next step will be to investigate whether there are signs of spatial clustering. Should clustering be present, we will then identify the locations of these clusters. Through this exercise, we aim to uncover the spatial patterns of development in the province.\n\n# 5.2 Data and Packages\n\nFor this exercise, we have the following two datasets:\n\n-   Hunan province administrative boundary layer at county level. This is a geospatial data set in ESRI shapefile format.\n\n-   Hunan_2012.csv: This csv file contains selected Hunanâ€™s local development indicators in 2012.\n\nThe packages used are as follows:\n\n-   **`sf`**: Provides simple features support for handling and analyzing spatial vector data in R.\n-   **`spdep`**: A package for spatial dependence and spatial regression analysis, particularly for handling spatial weights.\n-   **`tmap`**: A flexible visualization package for thematic maps, supporting both static and interactive mapping in R.\n-   **`tidyverse`**: A collection of R packages designed for data science, emphasizing data manipulation, visualization, and functional programming.\n-   `sfdep` is designed for spatial analysis, providing tools to work with spatial dependencies and spatial econometrics, particularly in conjunction with simple features (sf) objects. It helps analyze relationships and interactions between spatially distributed data.\n\nWe import these packages into our environment using the following code chunk.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, spdep, tmap, tidyverse, sfdep)\nset.seed(1234)\n```\n:::\n\n\n\n# 5.3 Importing the Data\n\n::: panel-tabset\n## Geospatial Data\n\nWe will use the st_read() function of the sf package to import the Hunan Shapefile into our environment.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan <- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `Hunan' from data source \n  `C:\\arjxn11\\ISSS626-GAA\\In-class_Ex\\In-class_Ex5\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n\n## Aspatial Data\n\nWe will use the read_csv() function of the readr package to import the Hunan_2012 data file.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan2012 <- read_csv(\"data/aspatial/Hunan_2012.csv\")\n```\n:::\n\n\n:::\n\n## 5.3.1 Performing relational join\n\nWe will update the attribute table of `Hunan`'s SpatialPolygonsDataFrame with the attribute fields of the `hunan2012` data-frame. We can do this by using the left_join() function of the dplyr package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan_GDPPC <- left_join(hunan,hunan2012) %>%\n  select(1:4, 7, 15)\n```\n:::\n\n\n\n### 5.3.1.2 Plotting a Choropleth map\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode('plot')\ntm_shape(hunan_GDPPC)+\n  tm_fill('GDPPC', style='quantile', palette = 'Blues', title= 'GDPPC')\n```\n\n::: {.cell-output-display}\n![](In-class_Ex5_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n# 5.4 Global and Local Measures of Spatial Autocorrelation: sfdep methods\n\n## 5.4.1 Deriving Queens Contiguity Weights: sfdep methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwm_q=hunan_GDPPC%>%\n  mutate(nb=st_contiguity(geometry),\n         wt=st_weights(nb,\n                       style='W'),\n         .before=1)\n```\n:::\n\n\n\n-   nb: A neighbor list object as created by st_neighbor.\n\n-   style: Default 'W' for row standardized weights. This value can also be 'B', 'C', 'U', 'minimax', and 'S'\n\n-   allow_zero: if TRUE, assigns zero as a lagged value to zone without neighbors.\n\n## 5.4.2 Computing Global Moran's I\n\nWe use the global_moran() function to compute this.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmoranI= global_moran(wm_q$GDPPC,\n                     wm_q$nb,\n                     wm_q$wt)\n```\n:::\n\n\n\nThe below code chunk, using global_moran_test() helps us conduct the test easier.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglobal_moran_test(wm_q$GDPPC,\n                  wm_q$nb,\n                  wm_q$wt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMoran I test under randomisation\n\ndata:  x  \nweights: listw    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n```\n\n\n:::\n:::\n\n\n\nSince p-value is less than 0.05, we infer that there is indeed a sign of positive autocorrelation.\n",
    "supporting": [
      "In-class_Ex5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}